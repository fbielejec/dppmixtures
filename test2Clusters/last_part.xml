	<!-- The unique patterns from 1 to end                                       -->
	<!-- npatterns=995                                                           -->
	<patterns id="patterns" from="1">
		<alignment idref="alignment"/>
	</patterns>

	<!-- fixed tree                                       -->
    <newick id="startingTree">
		(SimSeq1:73.7468,(SimSeq2:25.256989999999995,SimSeq3:45.256989999999995):18.48981);  
    </newick>

	<treeModel id="treeModel">
		<newick idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>

	<!-- The strict clock (Uniform rates across branches)                        -->
	<strictClockBranchRates id="branchRates">
		<rate>
			<parameter id="clock.rate" value="10E-3" lower="0.0" upper="100.0"/>
		</rate>
	</strictClockBranchRates>

<!-- START: DPP -->

<parameter id="mu0" value="0.0" />
<parameter id="P0" value="1.0"/>  
<parameter id="gamma" value="0.01" />

<compoundParameter id="uniquelyRealizedParameters">
    <parameter id="kappa.0" value="5.0" />
    <parameter id="kappa.1" value="10.0" />
</compoundParameter>

 <multivariateNormalDistributionModel id="baseModel">
      <meanParameter>
         <parameter idref="mu0" />
      </meanParameter>
      <precisionParameter>
         <matrixParameter>
           		<parameter idref="P0"/>
         </matrixParameter>
      </precisionParameter>
   </multivariateNormalDistributionModel>

   <dirichletProcessPrior id="dpp">

      <!-- start all assignments in cluster "value" -->
      <categories>
         <parameter id="uCategories" value="0" dimension="2" lower="0" upper="1" />
      </categories>

      <compoundParameter idref="uniquelyRealizedParameters" />

      <baseModel>
         <multivariateNormalDistributionModel idref="baseModel" />
      </baseModel>

      <concentration>
          <parameter idref="gamma" />
      </concentration>

   </dirichletProcessPrior>

   <countableRealizationsParameter id="allRealizedValues">
      <categories>
         <parameter idref="uCategories" />
      </categories>
      <compoundParameter idref="uniquelyRealizedParameters" />
   </countableRealizationsParameter>

<!-- END: DPP -->

<!-- START: SUBSTITUTION MODELS -->

	  <frequencyModel id="freqModel" dataType="nucleotide">
                 <frequencies>
                      <parameter id="frequencies" dimension="4" value="0.25 0.25 0.25 0.25"/>
                 </frequencies>
     </frequencyModel>

     <hkyModel id="hky.0">
         <frequencies>
             <frequencyModel idref="freqModel"/>
         </frequencies>
         <kappa>
         	<maskedParameter id="k.0"	from="1" to="1">
         		<parameter idref="allRealizedValues"/>
         	</maskedParameter>
         </kappa>
     </hkyModel>
     
      <hkyModel id="hky.1">
         <frequencies>
             <frequencyModel idref="freqModel"/>
         </frequencies>
         <kappa>
         	<maskedParameter id="k.1"	from="2" to="2">
         		<parameter idref="allRealizedValues"/>
         	</maskedParameter>
         </kappa>
     </hkyModel>

<!-- END: SUBSTITUTION MODELS -->

	<siteModel id="siteModel.0">
		<substitutionModel> 
			<hkyModel idref="hky.0"/>
		</substitutionModel> 
	</siteModel>

	<siteModel id="siteModel.1">
		<substitutionModel> 
			<hkyModel idref="hky.1"/>
		</substitutionModel> 
	</siteModel>

	<treeLikelihood id="treeLikelihood.0">
		<patterns idref="patterns"/>
		<treeModel idref="treeModel"/>
		<siteModel idref="siteModel.0"/>
        <strictClockBranchRates idref="branchRates"/>
	</treeLikelihood>

	<treeLikelihood id="treeLikelihood.1">
		<patterns idref="patterns"/>
		<treeModel idref="treeModel"/>
		<siteModel idref="siteModel.1"/>
        <strictClockBranchRates idref="branchRates"/>
	</treeLikelihood>

	<!-- Branch Likelihood                                                       -->
 <beagleBranchLikelihood id="branchLikelihood">

      <treeModel idref="treeModel"/>
      
      <categories>
         <parameter idref="uCategories" />
      </categories>

      <uniqueLikelihoods>
        <treeLikelihood idref="treeLikelihood.0"/>
	    <treeLikelihood idref="treeLikelihood.1"/>
	  </uniqueLikelihoods>

  </beagleBranchLikelihood>

   <!-- Define operators                                                        -->
	<operators id="operators">
	
	<!--dpp operator -->
      <dpOperator mhSteps="5" weight="3">
      	<dirichletProcessPrior idref="dpp"/>
      	
      	<categories>
      	    <parameter idref="uCategories"/>
      	</categories>
      	
      	 <compoundParameter idref="uniquelyRealizedParameters" />
      	
      	<dataLogLikelihood>
      	<!--
            <compoundLikelihood idref="compoundLikelihood"/>
            -->
             <beagleBranchLikelihood idref="branchLikelihood"/>
        </dataLogLikelihood>
      
      </dpOperator>

	<!--parameters operator -->
     <randomWalkOperator windowSize="0.1" weight="3">
      	<compoundParameter idref="uniquelyRealizedParameters" />
      </randomWalkOperator>

	</operators>


	<!-- Define MCMC                                                             -->
	<mcmc id="mcmc" chainLength="1000000" autoOptimize="true">
		<posterior id="posterior">
		
			<prior id="prior">
              <dirichletProcessPrior idref="dpp"/>
			</prior>
			
             <beagleBranchLikelihood idref="branchLikelihood"/>
			
		</posterior>
		
		<operators idref="operators"/>

		<log id="screenLog" logEvery="1000">

            <compoundParameter idref="uniquelyRealizedParameters" />
			<parameter idref="uCategories"/>

		</log>

<!--  
		<logTree id="treeFileLog" logEvery="100" nexusFormat="true" fileName="mcmc.trees" sortTranslationTable="true">
			<treeModel idref="treeModel"/>
            <branchSpecificTrait idref="branchSpecificKappa"/> 
		</logTree>
 -->

	</mcmc>


</beast>

